---
title: "Understanding Factors That Affects the Existence of Digital Innovation Hubs"
subtitle: "An Analysis of Toronto Libraries' Data"
author: "Yanzun Jiang"
thanks: "Code and data are available at: [https://github.com/Stary54264/relationship_between_attributes_and_whether_dih_exists_in_toronto_libraries](https://github.com/Stary54264/relationship_between_attributes_and_whether_dih_exists_in_toronto_libraries)."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(arrow)
library(rstanarm)
library(here)
library(knitr)
library(kableExtra)
library(modelsummary)
library(performance)
```

\newpage

# Introduction

Despite the growing importance of innovation hubs in the global economy, the factors influencing the presence of Digital Innovation Hubs (DIH) in facilities remain under-explored and needed to be filled. This paper seeks to identify the key factors that influence whether a library in Toronto has a DIH, focusing on attributes such as area size, the number of public parking spots, the number of workstations in the library, and the number of years from the library was built.

To investigate these factors, a logistic regression model was utilized, which is ideal for predicting binary outcomes (the presence or absence of a DIH). This analysis aims to estimate the likelihood of a library having a DIH based on these attributes. The dataset used in this study contains information on various libraries in Toronto. After data cleaning, relevant variables was selected to do data analysis. The logistic regression model will reveal how each attribute (area size, parking availability, number of workstations, and age of the building) impacts the presence of a DIH.

Results

DIHs are vital in fostering entrepreneurship, driving economic development, and supporting technological advancements. Understanding the attributes that contribute to the likelihood of a library of having a DIH could provide valuable insights for urban planners and policymakers.

The remainder of this paper is structured as follows: @sec-data discusses the data used in this analysis, including an overview of the dataset and key descriptive statistics. @sec-model outlines the logistic regression model, its assumptions, and its interpretation. @sec-results presents the results of the model, including the significance of each attribute in predicting the presence of a DIH. @sec-discussion offers a discussion of the findings, examines how these attributes affect DIH presence, and lists some weakness of this analysis. @sec-appendix provides extra tables and graphs to further explain the findings in this paper.

Statistical analysis is performed using `R` [@r], with packages `tidyverse` [@tidyverse], `arrow` [@arrow], `janitor` [@janitor], `testthat` [@testthat], `here` [@here], `modelsummary` [@modelsummary], `performance` [@performance], `knitr` [@knitr], `kableExtra` [@kableExtra], and `rstanarm` [@rstanarm].

## Estimand

The estimand in this paper is the presence of a Digital Innovation Hub (DIH) in a library. However, accurately observing which libraries have a DIH is not straightforward due to several challenges faced by urban planners. They may not have access to complete or up-to-date information about all libraries. This lack of comprehensive data, combined with regional variations and different reporting standards, makes it difficult to directly know the presence of a DIH across all libraries. To address this issue, a logistic regression model was built, since it allows us to estimate the probability of a facility having a DIH based on key attributes available in the dataset. By doing so, we aim to provide urban planners with insights into which factors most strongly influence the presence of DIHs, despite the challenges in directly measuring this estimand.

# Data {#sec-data}

```{r}
#| include: false
#| warning: false
#| message: false

data <- read_parquet(
  here::here("data/02-analysis_data/analysis_data.parquet"))
```
 
This report uses a dataset collected by Toronto Public Library [@library] and posted on Open Data Toronto [@data]. [@tbl-data] is a preview of the dataset. These data provide valuable insights into the physical attributes and temporal characteristics of libraries that may house DIHs. Alternative datasets, such as those focusing on municipal buildings or educational institutions, were considered but ultimately not used because libraries are more accessible to public, thus having a bigger impact on the society. The dataset includes predictor variables including library area, public parking spots, the number of workstations, and the year the library was built. Data on these variables would be used to predict the outcome variable - the presence of DIHs.

## Variables

One outcome variable and four predictor variables are used in the model:

`dih`: The presence of DIHs in libraries in Toronto. If there is one or more DIHs in the library, this field is set to 1; otherwise, this field is set to 0.

`area`: The total size of the library measured in square feet.

`parking`: The number of parking spaces available for the public. If a branch does not have any public parking spaces or shares parking spaces with another location, this field is set to 0.

`workstations`: A count of computers with internet access available for public use in the branch.

`year`: The number of years from the year that the present location of the library was officially opened to the general public. This variable was constructed using the formula $year=2024-year~built$. The age of the library was used instead of the year that the library was built since the age shows the degree of newness, which might affect the presence of DIHs. However, the year built is not that direct.

Their descriptive statistics and graphs of their distribution is included in @sec-dsg.

## Measurement
	
The library dataset used in this study was collected through a combination of administrative records and self-reported surveys. While the dataset provides valuable insights, several factors need to be considered:

Reporting Variability: Libraries differ in how they track and report operational data, leading to potential inconsistencies. For instance, “workstations” might only include computers in some libraries, while others might also count other types of technological infrastructure.

Survey Limitations: The presence of a DIH was self-reported, which could result in over- or under-representation of actual DIHs. Some respondents might interpret “Digital Innovation Hub” differently based on their regional or institutional context.

Geographical Coverage: The dataset might not represent all regions equally. Libraries in rural areas may be underrepresented, impacting the generalization of the findings.

### Connection with Real-World

The dataset connects real-world phenomena to measurable entries. For example:

`area`: The size of a library, measured in square feet, reflects its physical capacity to host community activities, including DIHs. Size of library would affect the presence of DIHs.

`parking`: The number of parking spaces captures the the likelihood of a library being visited. If a library is more likely to be visited, it would have more facilities.

`workstations`: Number of workstations symbolize a library's technological infrastructure - computers and other digital tools that enable public access to the internet, software, and other resources. Libraries with more computers is likely to have DIHs.

`year`: Newer libraries are often designed to meet current technological needs, making them more suitable for DIHs.

`dih`: The presence of a DIH at a library provides a learning opportunity for the public.

# Model {#sec-model}

```{r}
#| include: false
#| warning: false
#| message: false

model <- readRDS(here::here("models/model.rds"))
```

In this analysis, a Bayesian logistic regression model was used to examine the relationship between the presence of a DIH in libraries and key library attributes.

Our assumptions include that samples could represent every library in Toronto, observations should be independent with each other, and no perfect multicollinearity between predictor variables.

There are some limitations of our model. The model would be no longer valid if the actual underlying relationship between the predictor variables and the outcome variable is non-linear. Also, the predictor variables might not follow normal distribution.

Additional predictor variables include position of the library (longitude and latitude). However, while the position of the library could affect the presence of DIHs indeed, the longitude and latitude are not associated with it linearly.

## Model set-up

Define $y_i$ as whether a library has a DIH (0 for no and 1 for yes) with probability $p_i$, so it follows a Bernoulli distribution. Then, the logistic link function of $p_i$ is a linear combination of the intercept - $\beta_0$, and the effects of the predictor variables - $\beta_1$, $\beta_2$, $\beta_3$, and $\beta_4$ times the predictor variables respectively.

\begin{align} 
y_i|p_i &\sim \mbox{Bern}(p_i) \\
\mbox{logit}(p_i) &= \beta_0 + \beta_1 \times \mbox{area}_i + \beta_2 \times \mbox{parking}_i + \beta_3 \times \mbox{workstations}_i + \beta_4 \times \mbox{year}_i \\
\beta_0 &\sim \mbox{Normal}(0, 2.5) \\
\beta_1 &\sim \mbox{Normal}(0, 2.5) \\
\beta_2 &\sim \mbox{Normal}(0, 2.5) \\
\beta_3 &\sim \mbox{Normal}(0, 2.5) \\
\beta_4 &\sim \mbox{Normal}(0, 2.5)
\end{align}

Since we have no prior information about any variable, the prior of the intercept and coefficients was set to a normal distribution with $\mu=0$ and $\sigma=2.5$. We run the model in R [@r] using the `rstanarm` package [@rstanarm].

## Model justification

We propose the following hypotheses regarding how library attributes influence the likelihood of having DIHs.

`area`: We anticipate that larger libraries are more likely to host DIHs. Greater area reflects increased physical capacity, enabling libraries to allocate dedicated spaces for innovation and technology.

`parking`: The number of parking spaces is expected to positively correlate with the presence of a DIH. Parking facilities make libraries more accessible to the public, encouraging diverse patronage and increasing community engagement. Libraries with better accessibility might be more willing to improve its facilities and might receive greater funding and community support, promoting the establishment of advanced facilities like DIHs.

`workstations`: A strong positive relationship between the number of workstations and the presence of a DIH is expected. Workstations, representing technological infrastructure, are often central to the function of a DIH. Libraries with more workstations are likely equipped with the resources needed to support digital innovation and technological engagement.

`year`: We hypothesize a negative relationship between years since built and the likelihood of having a DIH. Older libraries might lack modern infrastructure and technological resources necessary for a DIH, whereas recently built or renovated libraries are more likely to own technological innovations aligned with the concept of a DIH.

# Results {#sec-results}

Our model results are summarized in @tbl-model. The findings align with our prior expectations in some degree and provide insights into the relationship between the predictor variables and the presence of DIHs. The intercept is negative, showing that more libraries do not have a DIH. The coefficient of `area` is 0, meaning the area of the library has litte effect on the outcome variable. The slope of `parking` and `workstations` are all positive, meaning a increase in them would lead to a higher likelihood of having DIHs. Rather, `year` has a negative slope, meaning older libraries are less likely to have a DIH, which aligns with our assumption.

The $R^2$ for this model is quite small, meaning the model might not fit the data well. However, the $RMSE$ is also quite small, meaning the problem of overfit would not present in our model. More details are included in @sec-md.

\clearpage

```{r, fig.pos="H"}
#| label: tbl-model
#| tbl-cap: "Summary Statistics of the Logistic Regression Model"
#| message: false
#| warning: false
#| echo: false

modelsummary(model, output = "kableExtra")
```

# Discussion {#sec-discussion}

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-#sec-appendix}

# Descriptive Statistics and Graphs of the Dataset {#sec-dsg}

## Preview of the Dataset

```{r, fig.pos="H"}
#| label: tbl-data
#| tbl-cap: "Preview of the Toronto Libraries Dataset"
#| message: false
#| echo: false

kable(head(data))
```

## Descriptive Statistics

```{r, fig.pos="H"}
#| label: tbl-area
#| tbl-cap: "Descriptive Statistics of `area`"
#| message: false
#| echo: false

kable(data |> summarize(Mean = round(mean(area), 1),
                        Median = median(area),
                        Minimum = min(area),
                        Maximum = max(area),
                        IQR = round(IQR(area), 1)))
```

```{r, fig.pos="H"}
#| label: tbl-parking
#| tbl-cap: "Descriptive Statistics of `parking`"
#| message: false
#| echo: false

kable(data |> summarize(Mean = round(mean(parking), 1),
                        Median = median(parking),
                        Minimum = min(parking),
                        Maximum = max(parking),
                        IQR = round(IQR(parking), 1)))
```

```{r, fig.pos="H"}
#| label: tbl-workstations
#| tbl-cap: "Descriptive Statistics of `workstations`"
#| message: false
#| echo: false

kable(data |> summarize(Mean = round(mean(workstations), 1),
                        Median = median(workstations),
                        Minimum = min(workstations),
                        Maximum = max(workstations),
                        IQR = round(IQR(workstations), 1)))
```

```{r, fig.pos="H"}
#| label: tbl-year
#| tbl-cap: "Descriptive Statistics of `year`"
#| message: false
#| echo: false

kable(data |> summarize(Mean = round(mean(year), 1),
                        Median = median(year),
                        Minimum = min(year),
                        Maximum = max(year),
                        IQR = round(IQR(year), 1)))
```

## Graphs

From @fig-dih, we could see that more libraries do not have a DIH. All predictor variables are right-skewed (@fig-area, @fig-parking, and @fig-workstations), except `year` (@fig-year). `year` might follows a normal distribution, while other predictor variables might follows an exponential distribution.

```{r, fig.pos="H"}
#| label: fig-dih
#| fig-cap: "Presence of DIHs in Toronto Libraries"
#| message: false
#| echo: false

data |> ggplot(aes(x = dih)) +
  geom_bar(col = "lightblue", fill = "lightblue", alpha = 0.8) +
  labs(x = "Presence of DIHs", y = "# of Libraries") +
  theme_minimal()
```

```{r, fig.pos="H"}
#| label: fig-area
#| fig-cap: "Distribution of Total Areas of Libraries in Toronto"
#| message: false
#| echo: false

data |> ggplot(aes(x = area)) +
  geom_histogram(col = "lightblue", fill = "lightblue", alpha = 0.8) +
  labs(x = "Total Area of the Library", y = "# of Libraries") +
  theme_minimal()
```

```{r, fig.pos="H"}
#| label: fig-parking
#| fig-cap: "Distribution of Number of Parking Spaces at Libraries in Toronto"
#| message: false
#| echo: false

data |> ggplot(aes(x = parking)) +
  geom_histogram(col = "lightblue", fill = "lightblue", alpha = 0.8) +
  labs(x = "# of Parking Spaces in the Library", y = "# of Libraries") +
  theme_minimal()
```

```{r, fig.pos="H"}
#| label: fig-workstations
#| fig-cap: "Distribution of Number of Workstations in Libraries in Toronto"
#| message: false
#| echo: false

data |> ggplot(aes(x = workstations)) +
  geom_histogram(col = "lightblue", fill = "lightblue", alpha = 0.8) +
  labs(x = "# of Workstations in the Library", y = "# of Libraries") +
  theme_minimal()
```

```{r, fig.pos="H"}
#| label: fig-year
#| fig-cap: "Distribution of Age of Libraries in Toronto"
#| message: false
#| echo: false

data |> ggplot(aes(x = year)) +
  geom_histogram(col = "lightblue", fill = "lightblue", alpha = 0.8) +
  labs(x = "Age of the Library", y = "# of Libraries") +
  theme_minimal()
```

# Model Details {#sec-md}

## Distribution of Posterior

The distribution of posterior is shown in @fig-posterior, which aligns with the actual data. From the graph, we can see that more libraries does not have a DIH.

```{r, fig.pos="H"}
#| label: fig-posterior
#| fig-cap: "Posterior Distribution for the Logistic Regression Model"
#| echo: false
#| warning: false
#| message: false

pp_check(model) +
  theme_minimal()
```

## Density Plots

From @fig-area-dih, we could see that smaller libraries are likely to have no DIHs, while larger libraries are not sure to have DIHs. In @fig-parking-dih and @fig-workstations-dih, libraries with more parking spaces and workstations tends to have a DIH. On the opposite, the pattern shown in @fig-year-dih tells us older libraries tend to have no DIH.

```{r, fig.pos="H"}
#| label: fig-area-dih
#| tbl-cap: "Density of `area` Categorized by Presence of DIHs"
#| message: false
#| echo: false

data |> ggplot(aes(x = area, fill = as.factor(dih))) +
  geom_density(alpha = 0.5) +
  labs(x = "Total Area of the Library", y = "Density", 
       fill = "Presence of DIHs (0 = No, 1 = Yes)") +
  theme_minimal()
```

```{r, fig.pos="H"}
#| label: fig-parking-dih
#| tbl-cap: "Density of `parking` Categorized by Presence of DIHs"
#| message: false
#| echo: false

data |> ggplot(aes(x = parking, fill = as.factor(dih))) +
  geom_density(alpha = 0.5) +
  labs(x = "# of Parking Spaces in the Library", y = "Density", 
       fill = "Presence of DIHs (0 = No, 1 = Yes)") +
  theme_minimal()
```

```{r, fig.pos="H"}
#| label: fig-workstations-dih
#| tbl-cap: "Density of `workstations` Categorized by Presence of DIHs"
#| message: false
#| echo: false

data |> ggplot(aes(x = workstations, fill = as.factor(dih))) +
  geom_density(alpha = 0.5) +
  labs(x = "# of Workstations in the Library", y = "Density", 
       fill = "Presence of DIHs (0 = No, 1 = Yes)") +
  theme_minimal()
```

```{r, fig.pos="H"}
#| label: fig-year-dih
#| tbl-cap: "Density of `year` Categorized by Presence of DIHs"
#| message: false
#| echo: false

data |> ggplot(aes(x = year, fill = as.factor(dih))) +
  geom_density(alpha = 0.5) +
  labs(x = "Age of the Library", y = "Density", 
       fill = "Presence of DIHs (0 = No, 1 = Yes)") +
  theme_minimal()
```

\newpage

# References
